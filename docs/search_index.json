[["23-Taggeo.html", "Chapter 6 Geographical tags 6.1 Manual correctio n of dictionnary 6.2 Detection of geographical entities", " Chapter 6 Geographical tags library(knitr) library(dplyr) library(WikidataR) Warning: le package &#39;WikidataR&#39; a été compilé avec la version R 4.2.1 library(quanteda) 6.1 Manual correctio n of dictionnary The dictionnary elaboated by automatic procedures has been manually corrected and the new version is upload. dict&lt;-read.table(&quot;dict/worldgeo_dict_V4bis.csv&quot;, header=T, sep=&quot;;&quot;, encoding = &quot;UTF-8&quot;, quote = &#39;&quot;&#39;) 6.2 Detection of geographical entities We have elaborated a function for the extraction of geographical units based on the dictionary elaborated in previous section (dict) according to the language (lang), the decision to split some tokens (split) to move or not to lower case (tolow) and the possibility to add a list of compounds to be realized (comps) in order to eliminate ambiguities. extract_tags &lt;- function(qd = qd, # the corpus of interest lang = &quot;fr&quot;, # the language to be used dict = dict, # the dictionary of target code = &quot;id&quot; , # variable used for coding split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), # split list tolow = FALSE , # Tokenize text comps = c(&quot;Afrique du sud&quot;) # compounds ) { # Tokenize x&lt;-as.character(qd) if(length(split) &gt; 0) { reg&lt;-paste(split, collapse = &#39;|&#39;) x &lt;- gsub(reg,&quot; &quot;,x)} if(tolow) { x &lt;- tolower(x)} toks&lt;-tokens(x) # compounds if(length(split) &gt; 0) { reg&lt;-paste(split, collapse = &#39;|&#39;) comps&lt;- gsub(reg,&quot; &quot;,comps)} if(tolow) {comps &lt;- tolower(comps)} toks&lt;-tokens_compound(toks,pattern=phrase(comps)) # Load dictionaries and create compounds ## Target dictionary dict&lt;-dict[dict$lang==lang &amp; is.na(dict$label)==F,] target&lt;-dict[ntoken(dict$label)&gt;1,] labels &lt;-dict$label if(length(split) &gt; 0) { reg&lt;-paste(split, collapse = &#39;|&#39;) labels&lt;- gsub(reg,&quot; &quot;,labels)} if(tolow) {labels &lt;- tolower(labels)} toks&lt;-tokens_compound(toks,pattern=phrase(labels)) # create quanteda dictionary keys &lt;-gsub(&quot; &quot;,&quot;_&quot;,labels) qd_dict&lt;-as.list(keys) names(qd_dict)&lt;-dict[[code]] qd_dict&lt;-dictionary(qd_dict,tolower = FALSE) # Identify geo tags (states or reg or org ...) toks_tags &lt;- tokens_lookup(toks, qd_dict, case_insensitive = F) toks_tags &lt;- lapply(toks_tags, unique) toks_tags&lt;-as.tokens(toks_tags) list_tags&lt;-function(x){res&lt;-paste(x, collapse=&#39; &#39;)} docvars(qd)[[&quot;tags&quot;]]&lt;-as.character(lapply(toks_tags,FUN=list_tags)) docvars(qd)[[&quot;nbtags&quot;]]&lt;-ntoken(toks_tags) # Export results return(qd) } 6.2.1 Le Figaro (FRA) #dict&lt;-readRDS(&quot;dict/worldgeo_dict_V4.RDS&quot;) qd &lt;- readRDS(&quot;quanteda/fr_FRA_figaro.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) frcomps&lt;-c(&quot;Europe 1&quot;, &quot;Atlantic city&quot;, &quot;Loire-Atlantique&quot;, &quot;Pyrénées-Atlantique&quot;, &quot;Pyrénées-Atlantiques&quot;, &quot;Alpes-de-Haute-Provence&quot;, &quot;Hautes-Alpes&quot;, &quot;Rhöne-Alpes&quot;,&quot;Alpes-Maritimes&quot;, &quot;Chantiers de l&#39;Atlantique&quot;, &quot;TGV Atlantique&quot;, &quot;Bourse de Paris&quot;, &quot;Paris SG&quot;, &quot;Ville de Paris&quot;, &quot;Grand Paris&quot;) qd &lt;- extract_tags (qd = qd, lang=&quot;fr&quot;, dict = dict, code = &quot;code&quot;, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), comps = frcomps, tolow = FALSE) saveRDS(qd,&quot;quanteda/fr_FRA_figaro_geo.RDS&quot;) qd1&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),regs=qd$tags,nbregs=qd$nbtags) 6.2.2 Le Monde qd &lt;- readRDS(&quot;quanteda/fr_FRA_lmonde.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) qd &lt;- extract_tags (qd = qd, lang=&quot;fr&quot;, dict = dict, code = &quot;code&quot;, comps = frcomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/fr_FRA_lmonde_geo.RDS&quot;) qd2&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.3 FAZ qd &lt;- readRDS(&quot;quanteda/de_DEU_frankf.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) decomps &lt;- c(&quot;Europa League&quot;) qd &lt;- extract_tags (qd = qd, lang=&quot;de&quot;, dict = dict, code = &quot;code&quot;, comps = decomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/de_DEU_frankf_geo.RDS&quot;) qd3&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.4 Süddeutsche Zeitung qd &lt;- readRDS(&quot;quanteda/de_DEU_suddeu.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) qd &lt;- extract_tags (qd = qd, lang=&quot;de&quot;, dict = dict, code = &quot;code&quot;, comps = decomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/de_DEU_suddeu_geo.RDS&quot;) qd4&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.5 Guardian qd &lt;- readRDS(&quot;quanteda/en_GBR_guardi.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) encomps&lt;-c(&quot;Atlantic City&quot;, &quot;Cathay Pacific&quot;, &quot;Virgin Atlantic&quot;) qd &lt;- extract_tags (qd = qd, lang=&quot;en&quot;, dict = dict, code = &quot;code&quot;, comps = encomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/en_GBR_guardi_geo.RDS&quot;) qd5&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.6 Daily Telegraph qd &lt;- readRDS(&quot;quanteda/en_GBR_telegr.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) qd &lt;- extract_tags (qd = qd, lang=&quot;en&quot;, dict = dict, code = &quot;code&quot;, comps = encomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/en_GBR_telegr_geo.RDS&quot;) qd6&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.7 Belfast Telegraph qd &lt;- readRDS(&quot;quanteda/en_NIR_beltel.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) qd &lt;- extract_tags (qd = qd, lang=&quot;en&quot;, dict = dict, code = &quot;code&quot;, comps = encomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/en_NIR_beltel_geo.RDS&quot;) qd7&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.8 Irish Times qd &lt;- readRDS(&quot;quanteda/en_IRL_irtime.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) qd &lt;- extract_tags (qd = qd, lang=&quot;en&quot;, dict = dict, code = &quot;code&quot;, comps = encomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/en_IRL_irtime_geo.RDS&quot;) qd8&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.9 Cumhuryet qd &lt;- readRDS(&quot;quanteda/tr_TUR_cumhur.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) trcomps &lt;- c(&quot;Cathay Pacific&quot;, &quot;Avrupa Ligi&quot;) qd &lt;- extract_tags (qd = qd, lang=&quot;tr&quot;, dict = dict, code = &quot;code&quot;, comps = trcomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/tr_TUR_cumhur_geo.RDS&quot;) qd9&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.10 Yeni Safak qd &lt;- readRDS(&quot;quanteda/tr_TUR_yenisa.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) qd &lt;- extract_tags (qd = qd, lang=&quot;tr&quot;, dict = dict, code = &quot;code&quot;, comps = trcomps, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/tr_TUR_yenisa_geo.RDS&quot;) qd10&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.11 El Khabar (DZA) qd &lt;- readRDS(&quot;quanteda/ar_DZA_elkahb.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) qd &lt;- extract_tags (qd = qd, lang=&quot;ar&quot;, dict = dict, code = &quot;code&quot;, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/ar_DZA_elkahb_geo.RDS&quot;) qd11&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.12 Al Chorouk (DZA) qd &lt;- readRDS(&quot;quanteda/ar_DZA_chorou.RDS&quot;) docvars(qd)&lt;-docvars(qd)[c(&quot;source&quot;,&quot;date&quot;)] qd&lt;-corpus_subset(qd,duplicated(as.character(qd))==FALSE) qd &lt;- extract_tags (qd = qd, lang=&quot;ar&quot;, dict = dict, code = &quot;code&quot;, split = c(&quot;&#39;&quot;,&quot;’&quot;,&quot;-&quot;), tolow = FALSE) saveRDS(qd,&quot;quanteda/ar_DZA_chorou_geo.RDS&quot;) qd12&lt;-qd table(qd$nbtags) x&lt;-data.frame(text=as.character(qd),tags=qd$tags,nbtags=qd$nbtags) 6.2.13 Global corpus qd &lt;- c(qd1,qd2,qd3,qd4,qd5,qd6,qd7,qd8,qd9,qd10,qd11,qd12) saveRDS(qd,&quot;quanteda/corpus_worldgeo_V3.RDS&quot;) table(qd$nbtags) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
