[["30-Hypercube.html", "Chapter 7 Hypercube 7.1 Objectives 7.2 Prepare data 7.3 Geographical entities", " Chapter 7 Hypercube library(knitr) library(dplyr) library(quanteda) library(data.table) library(tidytext) library(FactoMineR) library(Factoshiny) library(explor) 7.1 Objectives We have created a list of tags relate to world regions for news published in 14 newspapers. We propose now to build an hypercube in order to explore the results. 7.2 Prepare data 7.2.1 Load corpus qd&lt;-readRDS(&quot;quanteda/corpus_worldgeo_001.RDS&quot;) 7.2.2 Load hypercube function hypercube &lt;-function(qd = qd, when = &quot;date&quot;, when_cut = &quot;year&quot;, who = &quot;source&quot;, where1 = &quot;tags&quot;, where2 = &quot;tags&quot;) { # create data.table accroding to parameter chosen don&lt;-docvars(qd) df&lt;-data.table(id = docid(qd), who = don[,who], when = as.character(cut(don[,when],breaks=when_cut)), where1 = don[,where1], where2 = don[,where2]) # add code _no_ for empty fields df$where1[df$where1==&quot;&quot;]&lt;-&quot;_no_&quot; df$where2[df$where2==&quot;&quot;]&lt;-&quot;_no_&quot; # unnest where1 df&lt;-unnest_tokens(df,where1,where1,to_lower=F) # unnest where2 df&lt;-unnest_tokens(df,where2,where2,to_lower=F) # define number of occurence by id nb&lt;-df[,.N,list(id)] %&gt;% mutate(wgt = 1/N) %&gt;% select(-N) df&lt;-df %&gt;% left_join(nb) rm(nb) # Aggregate hc&lt;- df[,.( tags = .N, news=sum(wgt)) ,.(who, when,where1,where2)] # Convert date to time hc$when&lt;-as.Date(hc$when) # return hypercube return(hc) } 7.2.3 Create Hypercube hc_reg &lt;- hypercube(qd = qd, when = &quot;date&quot;, when_cut = &quot;months&quot;, who = &quot;source&quot;, where1 = &quot;tags&quot;, where2 = &quot;tags&quot;) Joining, by = &quot;id&quot; kable(head(hc_reg)) who when where1 where2 tags news fr_FRA_figaro 2019-01-01 no no 2481 2481.00 fr_FRA_figaro 2019-01-01 CA_JPN CA_JPN 6 5.25 fr_FRA_figaro 2019-01-01 ST_THA ST_THA 8 6.50 fr_FRA_figaro 2019-01-01 ST_COD ST_COD 25 22.75 fr_FRA_figaro 2019-01-01 ST_QAT ST_QAT 3 3.00 fr_FRA_figaro 2019-01-01 ST_GAB ST_GAB 5 5.00 7.2.4 Load Wikidata entity names reg_def&lt;-readRDS(&quot;dict/worldgeo_def_V1.RDS&quot;) # Choose language tab_def&lt;-reg_def %&gt;% filter(lang == &quot;en&quot;) kable(head(tab_def)) id lang label type code Q15 en Africa cont CO_AFR Q828 en Americas cont CO_AMR Q48 en Asia cont CO_ASI Q46 en Europe cont CO_EUR Q538 en Insular Oceania cont CO_OCE Q51 en Antarctica cont CO_ANT 7.3 Geographical entities 7.3.1 Which % of news ? What is the percentage of news where at less one geographical entity is mentioned ? hc_reg$tagged&lt;-hc_reg$where1!=&quot;_no_&quot; df&lt;-hc_reg[,list(nb = sum(news)), list(who, tagged)] %&gt;% dcast(formula = who~tagged, value.var = &quot;nb&quot;) names(df)&lt;-c(&quot;media&quot;,&quot;No&quot;, &quot;Yes&quot;) df$Tot = df$No+df$Yes df$Pct = 100*df$Yes/df$Tot df&lt;-df[order(df$Pct)] kable(df, digits=2) media No Yes Tot Pct ar_DZA_elkahb 49126 7710 56836 13.57 fr_DZA_elwata 8244 1414 9658 14.64 tr_TUR_cumhur 111949 19500 131449 14.83 de_DEU_frankf 74508 13563 88071 15.40 fr_TUN_presse 9544 1740 11284 15.42 en_NIR_beltel 81965 17095 99060 17.26 ar_DZA_alnaha 28907 6245 35152 17.77 en_IRL_irtime 85652 21101 106753 19.77 de_DEU_suddeu 28303 7094 35397 20.04 ar_TUN_babnet 33769 8588 42357 20.28 fr_TUN_ecomag 10050 2718 12768 21.29 en_GBR_telegr 29452 8452 37904 22.30 fr_TUN_realit 17709 5117 22826 22.42 tr_TUR_yenisa 74609 21562 96171 22.42 en_GBR_guardi 58080 18966 77046 24.62 fr_FRA_figaro 91861 36428 128289 28.40 fr_FRA_lmonde 33683 15872 49555 32.03 7.3.2 Which entities are the most mentionned ? Iw we put together all newspapers, we obtain the following table # Compute df&lt;-hc_reg[where1 !=&quot;_no_&quot;,list(nb = sum(news)), list(where1)] # df&lt;-as.data.frame(df) df&lt;-merge(tab_def,df,by.x=&quot;code&quot;,by.y=&quot;where1&quot;,all.x=F,all.y=T) df&lt;-df[order(df$nb, decreasing = T),] row.names(df)&lt;-1:dim(df)[1] kable(df, digits=0,row.names = T) code id lang label type nb 1 ST_USA Q30 en United States of America sta 12232 2 ST_IRL Q27 en Ireland sta 11993 3 ST_FRA Q142 en France sta 10831 4 ST_TUR Q43 en Turkey sta 8778 5 ST_TUN Q948 en Tunisia sta 6977 6 OR_EU Q458 en European Union org 6474 7 ST_CHN Q148 en Peoples Republic of China sta 6332 8 ST_CAN Q16 en Canada sta 6031 9 CA_FRA Q90 en Paris cap 5625 10 ST_DEU Q183 en Germany sta 5145 11 CO_EUR Q46 en Europe cont 4849 12 ST_DZA Q262 en Algeria sta 4021 13 CA_IRL Q1761 en Dublin cap 3940 14 ST_ITA Q38 en Italy sta 3926 15 ST_RUS Q159 en Russia sta 3812 16 ST_ISR Q801 en Israel sta 3461 17 ST_IRN Q794 en Iran sta 3228 18 ST_GBR Q145 en United Kingdom sta 3015 19 CA_TUN Q3572 en Tunis cap 2950 20 CA_DZA Q3561 en Algiers cap 2941 21 CA_GBR Q84 en London cap 2750 22 ST_LBY Q1016 en Libya sta 2574 23 ST_IND Q668 en India sta 2527 24 ST_ESP Q29 en Spain sta 2497 25 ST_AFG Q889 en Afghanistan sta 2421 26 CA_JPN Q1490 en Tokyo cap 2405 27 ST_AUS Q408 en Australia sta 2287 28 ST_SYR Q858 en Syria sta 1902 29 ST_JPN Q17 en Japan sta 1890 30 ST_GRC Q41 en Greece sta 1830 31 ST_BRA Q155 en Brazil sta 1794 32 CA_TUR Q3640 en Ankara cap 1792 33 CA_ESP Q2807 en Madrid cap 1712 34 CA_DEU Q64 en Berlin cap 1582 35 CO_AFR Q15 en Africa cont 1545 36 ST_SAU Q851 en Saudi Arabia sta 1488 37 CA_USA Q61 en Washington, D.C. cap 1426 38 ST_NZL Q664 en New Zealand sta 1224 39 ST_MAR Q1028 en Morocco sta 1169 40 ST_EGY Q79 en Egypt sta 1141 41 ST_UKR Q212 en Ukraine sta 1129 42 ST_IRQ Q796 en Iraq sta 1114 43 ST_VEN Q717 en Venezuela sta 1076 44 ST_MMR Q836 en Myanmar sta 1042 45 ST_QAT Q846 en Qatar sta 1006 46 ST_BLR Q184 en Belarus sta 952 47 ST_LBN Q822 en Lebanon sta 946 48 ST_MEX Q96 en Mexico sta 918 49 ST_ZAF Q258 en South Africa sta 885 50 ST_MLI Q912 en Mali sta 884 51 ST_AUT Q40 en Austria sta 870 52 ST_NLD Q29999 en Kingdom of the Netherlands sta 841 53 ST_BEL Q31 en Belgium sta 836 54 ST_AZE Q227 en Azerbaijan sta 836 55 SE_medit Q4918 en Mediterranean Sea sea 800 56 ST_POL Q36 en Poland sta 793 57 CA_ITA Q220 en Rome cap 782 58 ST_CHE Q39 en Switzerland sta 779 59 ST_PAK Q843 en Pakistan sta 779 60 CA_AFG Q5838 en Kabul cap 763 61 ST_PRK Q423 en North Korea sta 746 62 ST_ARM Q399 en Armenia sta 745 63 ST_SWE Q34 en Sweden sta 742 64 ST_NGA Q1033 en Nigeria sta 740 65 CA_BEL Q239 en City of Brussels cap 725 66 CA_RUS Q649 en Moscow cap 681 67 ST_DNK Q35 en Denmark sta 674 68 ST_ISL Q189 en Iceland sta 671 69 CA_CHN Q956 en Beijing cap 669 70 ST_PRT Q45 en Portugal sta 659 71 ST_SDN Q1049 en Sudan sta 641 72 ST_ARE Q878 en United Arab Emirates sta 574 73 ST_IDN Q252 en Indonesia sta 562 74 ST_GEO Q230 en Georgia sta 557 75 ST_YEM Q805 en Yemen sta 550 76 ST_COD Q974 en Democratic Republic of the Congo sta 545 77 ST_JOR Q810 en Jordan sta 541 78 ST_ARG Q414 en Argentina sta 541 79 ST_KOR Q884 en South Korea sta 530 80 CA_ISR Q1218 en Jerusalem cap 511 81 ST_HUN Q28 en Hungary sta 489 82 CO_ASI_minor Q12824780 en Asia Minor cont 477 83 OR_NATO Q7184 en NATO org 474 84 ST_MCO Q235 en Monaco sta 467 85 ST_COL Q739 en Colombia sta 447 86 ST_LKA Q854 en Sri Lanka sta 440 87 SE_black Q166 en Black Sea sea 432 88 ST_NOR Q20 en Norway sta 421 89 ST_THA Q869 en Thailand sta 394 90 CA_LBN Q3820 en Beirut cap 358 91 ST_PER Q419 en Peru sta 357 92 ST_TWN Q865 en Taiwan sta 353 93 ST_CIV Q1008 en Côte dIvoire sta 341 94 ST_ETH Q115 en Ethiopia sta 337 95 ST_VAT Q237 en Vatican City sta 324 96 ST_HTI Q790 en Haiti sta 322 97 ST_CHL Q298 en Chile sta 318 98 LA_east_middle Q7204 en Middle East land 314 99 CO_ASI Q48 en Asia cont 313 100 CA_AUT Q1741 en Vienna cap 311 101 ST_CUB Q241 en Cuba sta 304 102 CA_MEX Q1489 en Mexico City cap 298 103 ST_PHL Q928 en Philippines sta 298 104 ST_HRV Q224 en Croatia sta 279 105 ST_NER Q1032 en Niger sta 272 106 ST_BOL Q750 en Bolivia sta 265 107 CA_SYC Q3940 en Victoria cap 262 108 ST_ZWE Q954 en Zimbabwe sta 262 109 ST_BFA Q965 en Burkina Faso sta 256 110 ST_GIN Q1006 en Guinea sta 249 111 ST_SEN Q1041 en Senegal sta 247 112 LA_sahel Q66065 en Sahel land 247 113 LA_alpen Q1286 en Alps land 240 114 ST_KEN Q114 en Kenya sta 237 115 ST_VUT Q686 en Vanuatu sta 234 116 ST_BGR Q219 en Bulgaria sta 233 117 CA_IRQ Q1530 en Baghdad cap 232 118 ST_CZE Q213 en Czech Republic sta 231 119 ST_RWA Q1037 en Rwanda sta 227 120 ST_CMR Q1009 en Cameroon sta 225 121 ST_CYP Q229 en Cyprus sta 224 122 CA_IRN Q3616 en Tehran cap 221 123 ST_VNM Q881 en Vietnam sta 221 124 ST_ROU Q218 en Romania sta 220 125 ST_BGD Q902 en Bangladesh sta 220 126 CA_GRC Q1524 en Athens cap 219 127 CA_LBY Q3579 en Tripoli cap 218 128 ST_FIN Q33 en Finland sta 216 129 ST_SRB Q403 en Serbia sta 213 130 CA_EGY Q85 en Cairo cap 212 131 ST_BHR Q398 en Bahrain sta 206 132 ST_MYS Q833 en Malaysia sta 204 133 SE_arcti Q25322 en Arctic sea 182 134 ST_MOZ Q1029 en Mozambique sta 180 135 ST_SVK Q214 en Slovakia sta 179 136 CO_AMR Q828 en Americas cont 178 137 ST_MRT Q1025 en Mauritania sta 173 138 CA_NLD Q727 en Amsterdam cap 172 139 ST_UGA Q1036 en Uganda sta 171 140 CA_QAT Q3861 en Doha cap 168 141 ST_MUS Q1027 en Mauritius sta 163 142 ST_MLT Q233 en Malta sta 161 143 ST_SOM Q1045 en Somalia sta 160 144 ST_TCD Q657 en Chad sta 151 145 ST_TZA Q924 en Tanzania sta 149 146 CA_CZE Q1085 en Prague cap 140 147 ST_KGZ Q813 en Kyrgyzstan sta 138 148 ST_MDG Q1019 en Madagascar sta 137 149 CA_ARE Q1519 en Abu Dhabi cap 137 150 ST_NIC Q811 en Nicaragua sta 134 151 SE_pacif Q98 en Pacific Ocean sea 132 152 CO_AMR_latin Q12585 en Latin America cont 131 153 ST_SLV Q792 en El Salvador sta 131 154 ST_MKD Q221 en North Macedonia sta 130 155 ST_ALB Q222 en Albania sta 130 156 SE_atlan Q97 en Atlantic Ocean sea 129 157 CA_SGP Q334 en Singapore cap 125 158 ST_SGP Q334 en Singapore sta 125 159 ST_GHA Q117 en Ghana sta 124 160 ST_KAZ Q232 en Kazakhstan sta 122 161 LA_sahara Q6583 en Sahara land 120 162 LA_mashr Q28227 en Maghreb land 118 163 ST_OMN Q842 en Oman sta 117 164 CA_PRT Q597 en Lisbon cap 117 165 ST_CAF Q929 en Central African Republic sta 116 166 CA_SEN Q3718 en Dakar cap 115 167 CO_ANT Q51 en Antarctica cont 112 168 ST_ECU Q736 en Ecuador sta 112 169 LA_amazon Q2841453 en Amazonia land 110 170 ST_BIH Q225 en Bosnia and Herzegovina sta 109 171 ST_DMA Q784 en Dominica sta 106 172 CA_UKR Q1899 en Kyiv cap 103 173 CA_KOR Q8684 en Seoul cap 103 174 ST_ZMB Q953 en Zambia sta 103 175 ST_LTU Q37 en Lithuania sta 100 176 CA_SAU Q3692 en Riyadh cap 99 177 CA_HUN Q1781 en Budapest cap 98 178 ST_BWA Q963 en Botswana sta 94 179 CA_AZE Q9248 en Baku cap 94 180 ST_KHM Q424 en Cambodia sta 89 181 CO_AFR_south Q27394 en Southern Africa cont 88 182 ST_BEN Q962 en Benin sta 87 183 CA_BGR Q472 en Sofia cap 86 184 ST_MNE Q236 en Montenegro sta 86 185 SE_carai Q664609 en Caribbean sea 85 186 CA_KWT Q35178 en Kuwait City cap 83 187 CA_DNK Q1748 en Copenhagen cap 82 188 ST_SVN Q215 en Slovenia sta 82 189 ST_KWT Q817 en Kuwait sta 82 190 ST_NPL Q837 en Nepal sta 81 191 CA_SYR Q3766 en Damascus cap 81 192 ST_SSD Q958 en South Sudan sta 80 193 ST_FJI Q712 en Fiji sta 80 194 SE_polyn Q35942 en Polynesia sea 78 195 ST_EST Q191 en Estonia sta 74 196 ST_MDA Q217 en Moldova sta 74 197 ST_GTM Q774 en Guatemala sta 73 198 CO_AMR_south Q18 en South America cont 71 199 OR_CoEur Q8908 en Council of Europe org 70 200 CA_POL Q270 en Warsaw cap 70 201 CA_LUX Q1842 en Luxembourg cap 70 202 ST_LUX Q32 en Luxembourg sta 70 203 LA_east_near Q48214 en Near East land 69 204 ST_URY Q77 en Uruguay sta 69 205 ST_HND Q783 en Honduras sta 69 206 CO_ERA Q5401 en Eurasia cont 68 207 CA_PRK Q18808 en Pyongyang cap 67 208 CA_THA Q1861 en Bangkok cap 66 209 ST_AND Q228 en Andorra sta 63 210 ST_BHS Q778 en The Bahamas sta 63 211 ST_NAM Q1030 en Namibia sta 63 212 CA_BLR Q2280 en Minsk cap 62 213 ST_LVA Q211 en Latvia sta 61 214 ST_JAM Q766 en Jamaica sta 57 215 CA_SRB Q3711 en Belgrade cap 56 216 ST_UZB Q265 en Uzbekistan sta 56 217 CA_SWE Q1754 en Stockholm cap 55 218 ST_PNG Q691 en Papua New Guinea sta 54 219 ST_MDV Q826 en Maldives sta 54 220 ST_PRY Q733 en Paraguay sta 54 221 ST_PAN Q804 en Panama sta 52 222 OR_ArLig Q7172 en Arab League org 51 223 LA_balka Q23522 en Balkans land 50 224 OR_Merco Q4264 en Mercosur org 50 225 CO_AMR_centr Q27611 en Central America cont 49 226 CA_NOR Q585 en Oslo cap 49 227 ST_TJK Q863 en Tajikistan sta 48 228 CA_CUB Q1563 en Havana cap 48 229 ST_MWI Q1020 en Malawi sta 47 230 ST_COG Q971 en Republic of the Congo sta 47 231 CA_FIN Q1757 en Helsinki cap 47 232 CO_AFR_west Q4412 en West Africa cont 47 233 OR_AfrUn Q7159 en African Union org 46 234 ST_CRI Q800 en Costa Rica sta 46 235 ST_SLB Q685 en Solomon Islands sta 46 236 CA_HRV Q1435 en Zagreb cap 45 237 ST_BDI Q967 en Burundi sta 44 238 CA_CHE Q70 en Bern cap 43 239 CA_VNM Q1858 en Hanoi cap 43 240 ST_WSM Q683 en Samoa sta 42 241 CA_ZWE Q3921 en Harare cap 42 242 CO_AMR_north Q49 en North America cont 42 243 CO_AMR_north Q2017699 en Northern America cont 42 244 ST_GMB Q1005 en The Gambia sta 41 245 CA_IND Q987 en New Delhi cap 40 246 ST_GAB Q1000 en Gabon sta 39 247 CA_MLT Q23800 en Valletta cap 38 248 OR_comwl Q7785 en Commonwealth of Nations org 37 249 SE_antil Q166131 en Antilles sea 36 250 ST_AGO Q916 en Angola sta 36 251 ST_GNQ Q983 en Equatorial Guinea sta 36 252 CA_PAN Q3306 en Panama City cap 35 253 LA_cauca Q18869 en Caucasus land 35 254 CA_ARG Q1486 en Buenos Aires cap 34 255 CA_MAR Q3551 en Rabat cap 34 256 CA_COL Q2841 en Bogotá cap 34 257 CA_IDN Q3630 en Jakarta cap 34 258 CO_ASI_south_east Q11708 en Southeast Asia cont 34 259 LA_himal Q5451 en Himalayas land 33 260 CA_BIH Q11194 en Sarajevo cap 33 261 CA_VEN Q1533 en Caracas cap 33 262 ST_BRN Q921 en Brunei sta 32 263 ST_SLE Q1044 en Sierra Leone sta 31 264 CO_AFR_north Q27381 en North Africa cont 31 265 ST_MNG Q711 en Mongolia sta 31 266 ST_DJI Q977 en Djibouti sta 30 267 CA_CHL Q2887 en Santiago cap 30 268 CO_EUR_east_centr Q27468 en Eastern Europe cont 30 269 ST_BRB Q244 en Barbados sta 29 270 ST_TKM Q874 en Turkmenistan sta 29 271 CA_SOM Q2449 en Mogadishu cap 28 272 CA_SDN Q1963 en Khartoum cap 28 273 CA_DJI Q3604 en Djibouti cap 28 274 ST_TUV Q672 en Tuvalu sta 27 275 ST_TON Q678 en Tonga sta 27 276 CA_ARM Q1953 en Yerevan cap 26 277 CO_AFR_ssahr Q132959 en Sub-Saharan Africa cont 26 278 CA_KEN Q3870 en Nairobi cap 26 279 CO_ASI_centr Q27275 en Central Asia cont 26 280 CA_PER Q2868 en Lima cap 26 281 ST_VCT Q757 en Saint Vincent and the Grenadines sta 26 282 ST_DOM Q786 en Dominican Republic sta 25 283 ST_SYC Q1042 en Seychelles sta 25 284 ST_LIE Q347 en Liechtenstein sta 25 285 ST_TGO Q945 en Togo sta 24 286 ST_LBR Q1014 en Liberia sta 24 287 CO_ASI_pacif Q1070940 en Asia-Pacific cont 23 288 CA_AUS Q3114 en Canberra cap 23 289 CA_MLI Q3703 en Bamako cap 22 290 SE_china_south Q37660 en South China Sea sea 22 291 CA_COD Q3838 en Kinshasa cap 21 292 SE_persi Q34675 en Persian Gulf sea 21 293 CA_KAZ Q1520 en Nur-Sultan cap 21 294 CA_PHL Q1461 en Manila cap 21 295 SE_india Q1239 en Indian Ocean sea 20 296 CA_ISL Q1764 en Reykjavík cap 20 297 CA_SMR Q1848 en San Marino cap 19 298 ST_SMR Q238 en San Marino sta 19 299 ST_GNB Q1007 en Guinea-Bissau sta 19 300 CA_JOR Q3805 en Amman cap 19 301 CA_ETH Q3624 en Addis Ababa cap 19 302 CA_GTM Q1555 en Guatemala City cap 19 303 LA_scand Q21195 en Scandinavia land 18 304 ST_LSO Q1013 en Lesotho sta 18 305 CO_AFR_east Q27407 en East Africa cont 18 306 CA_RWA Q3859 en Kigali cap 17 307 CA_MCO Q55115 en Monaco City cap 17 308 CA_OMN Q3826 en Muscat cap 17 309 CO_EUR_centr Q27509 en Central Europe cont 17 310 CA_EST Q1770 en Tallinn cap 16 311 CA_GIN Q3733 en Conakry cap 16 312 ST_COM Q970 en Comoros sta 16 313 CA_TLS Q9310 en Dili cap 16 314 CA_ROU Q19660 en Bucharest cap 16 315 ST_GRD Q769 en Grenada sta 16 316 ST_ERI Q986 en Eritrea sta 15 317 CO_EUR_south Q27449 en Southern Europe cont 15 318 ST_MHL Q709 en Marshall Islands sta 15 319 CA_AGO Q3897 en Luanda cap 14 320 CA_LTU Q216 en Vilnius cap 14 321 LA_rocky Q5463 en Rocky Mountains land 14 322 CA_JAM Q34692 en Kingston cap 13 323 CA_CAN Q1930 en Ottawa cap 13 324 CA_SVK Q1780 en Bratislava cap 13 325 ST_CPV Q1011 en Cape Verde sta 12 326 ST_SUR Q730 en Suriname sta 12 327 ST_GUY Q734 en Guyana sta 12 328 CO_EUR_north Q27479 en Northern Europe cont 12 329 CA_MRT Q3688 en Nouakchott cap 11 330 CA_PAK Q1362 en Islamabad cap 11 331 OR_ECWAS Q193272 en Economic Community of West African States org 11 332 CO_ASI_south Q771405 en South Asia cont 11 333 CA_CAF Q3832 en Bangui cap 10 334 CA_LVA Q1773 en Riga cap 10 335 CA_GEO Q994 en Tbilisi cap 10 336 CA_BGD Q1354 en Dhaka cap 10 337 CA_BRA Q2844 en Brasília cap 10 338 ST_TLS Q574 en Timor-Leste sta 10 339 CO_AFR_centr Q27433 en Central Africa cont 9 340 ST_LAO Q819 en Laos sta 9 341 ST_SWZ Q1050 en Eswatini sta 9 342 ST_BTN Q917 en Bhutan sta 9 343 CA_NER Q3674 en Niamey cap 8 344 OR_TurCo Q596850 en Turkic Council org 8 345 CA_BFA Q3777 en Ouagadougou cap 8 346 CA_NRU Q31026 en Yaren District cap 8 347 CA_NZL Q23661 en Wellington cap 8 348 CA_CYP Q3856 en Nicosia cap 8 349 CA_ECU Q2900 en Quito cap 8 350 CA_YEM Q2471 en Sanaa cap 7 351 CA_SVN Q437 en Ljubljana cap 7 352 CA_GHA Q3761 en Accra cap 7 353 CA_TWN Q1867 en Taipei cap 7 354 CA_MYS Q1865 en Kuala Lumpur cap 6 355 CO_OCE Q538 en Insular Oceania cont 6 356 CA_GUY Q10717 en Georgetown cap 6 357 CA_LKA Q35381 en Colombo cap 6 358 CA_BHR Q3882 en Manama cap 6 359 CA_CRI Q3070 en San José cap 6 360 CA_GRD Q41547 en St. Georges cap 6 361 CA_UGA Q3894 en Kampala cap 6 362 CO_ASI_east Q27231 en East Asia cont 6 363 ST_PLW Q695 en Palau sta 6 364 ST_BLZ Q242 en Belize sta 5 365 ST_TTO Q754 en Trinidad and Tobago sta 5 366 ST_NRU Q697 en Nauru sta 5 367 CA_HTI Q34261 en Port-au-Prince cap 5 368 OR_Viseg Q244323 en Visegrád Group org 5 369 OR_CCASG Q217172 en Cooperation Council for the Arab States of the Gulf org 5 370 CA_ALB Q19689 en Tirana cap 4 371 CA_CMR Q3808 en Yaoundé cap 4 372 CO_EUR_west Q27496 en Western Europe cont 4 373 LA_anden Q5456 en Andes land 4 374 OR_OAS Q123759 en Organization of American States org 4 375 CA_MKD Q384 en Skopje cap 4 376 CA_NGA Q3787 en Abuja cap 4 377 CA_BHS Q2467 en Nassau cap 4 378 CA_COG Q3844 en Brazzaville cap 4 379 CA_TCD Q3659 en NDjamena cap 4 380 ST_LCA Q760 en Saint Lucia sta 4 381 CO_AFR_frenc Q210682 en French West Africa cont 4 382 CA_GNQ Q3818 en Malabo cap 4 383 CA_CPV Q3751 en Praia cap 4 384 CO_ASI_ind Q60140 en Indian subcontinent cont 4 385 ST_KIR Q710 en Kiribati sta 3 386 CA_BOL Q1491 en La Paz cap 3 387 CA_KGZ Q9361 en Bishkek cap 3 388 CA_LIE Q1844 en Vaduz cap 3 389 CA_SSD Q1947 en Juba cap 3 390 OR_Shang Q485207 en Shanghai Cooperation Organisation org 3 391 CA_GNB Q3739 en Bissau cap 3 392 CA_ERI Q3642 en Asmara cap 2 393 CA_SLE Q3780 en Freetown cap 2 394 CA_ZAF Q3926 en Pretoria cap 2 395 CA_ATG Q36262 en Saint Johns cap 2 396 CA_GAB Q3825 en Libreville cap 2 397 CA_NPL Q3037 en Kathmandu cap 2 398 CA_PRY Q2933 en Asunción cap 2 399 CO_EUR_east Q16389571 en East-Central Europe cont 2 400 OR_Asean Q7768 en ASEAN org 2 401 OR_PIF Q757276 en Pacific Islands Forum org 2 402 OR_RCEP Q11523819 en Regional Comprehensive Economic Partnership org 2 403 OR_SAARC Q145700 en South Asian Association for Regional Cooperation org 2 404 CA_KHM Q1850 en Phnom Penh cap 2 405 CO_EUR_south_east Q263686 en Southeast Europe cont 2 406 SE_china_east Q45341 en East China Sea sea 1 407 CA_LCA Q41699 en Castries cap 1 408 CA_MOZ Q3889 en Maputo cap 1 409 CA_UZB Q269 en Tashkent cap 1 410 CO_EUR_centr_east Q900636 en Central and Eastern Europe cont 1 411 OR_APEC Q170481 en Asia-Pacific Economic Cooperation org 1 412 OR_CIS Q7779 en Commonwealth of Independent States org 1 413 SE_micro Q3359409 en Micronesia sea 1 414 ST_FSM Q702 en Federated States of Micronesia sta 1 415 ST_KNA Q763 en Saint Kitts and Nevis sta 1 416 CA_DOM Q34820 en Santo Domingo cap 1 417 CA_BWA Q3919 en Gaborone cap 0 418 CA_MMR Q37400 en Naypyidaw cap 0 419 CA_MUS Q3929 en Port Louis cap 0 420 SE_melan Q37394 en Melanesia sea 0 7.3.3 Top non state entities by media # Compute df&lt;-hc_reg[where1 !=&quot;_no_&quot;,list(nb = sum(news)), list(where1, who)] %&gt;% group_by(who) %&gt;% filter((substr(where1,1,2) %in% c(&quot;CA&quot;,&quot;ST&quot;))==FALSE) %&gt;% mutate(pct = 100*nb/sum(nb), rnk = rank(-nb)) df&lt;-merge(tab_def,df,by.x=&quot;code&quot;,by.y=&quot;where1&quot;,all.x=F,all.y=T) res &lt;- df %&gt;% filter(rnk &lt; 11) %&gt;% select(who, rnk,label, pct) %&gt;% mutate(who=substr(who,4,12)) res&lt;-res[order(res$who, res$rnk),] kable(res,digits=c(0,1)) who rnk label pct 123 DEU_frank 1.0 European Union 48.3 57 DEU_frank 2.0 Europe 26.9 13 DEU_frank 3.0 Africa 3.5 158 DEU_frank 4.0 Mediterranean Sea 2.0 26 DEU_frank 5.0 Americas 1.9 42 DEU_frank 6.0 Asia 1.9 68 DEU_frank 7.0 Alps 1.6 74 DEU_frank 8.0 Middle East 1.5 24 DEU_frank 9.0 Southern Africa 1.4 65 DEU_frank 10.0 Eastern Europe 0.9 118 DEU_sudde 1.0 European Union 52.9 49 DEU_sudde 2.0 Europe 22.4 2 DEU_sudde 3.0 Africa 3.9 72 DEU_sudde 4.0 Middle East 3.8 165 DEU_sudde 5.0 Mediterranean Sea 2.7 66 DEU_sudde 6.0 Alps 2.4 32 DEU_sudde 7.0 South America 1.1 85 DEU_sudde 8.5 Near East 0.9 145 DEU_sudde 8.5 Arctic 0.9 23 DEU_sudde 10.0 Southern Africa 0.9 14 DZA_alnah 1.0 Africa 40.1 63 DZA_alnah 2.0 Europe 29.1 131 DZA_alnah 3.0 European Union 11.2 43 DZA_alnah 4.0 Asia 3.7 101 DZA_alnah 5.0 Sahel 3.6 77 DZA_alnah 6.0 Middle East 2.6 112 DZA_alnah 7.0 Arab League 2.3 166 DZA_alnah 8.0 Mediterranean Sea 2.0 89 DZA_alnah 9.0 Maghreb 1.3 136 DZA_alnah 10.0 NATO 0.9 9 DZA_elkah 1.0 Africa 55.0 61 DZA_elkah 2.0 Europe 20.9 117 DZA_elkah 3.0 European Union 7.4 156 DZA_elkah 4.0 Mediterranean Sea 3.8 37 DZA_elkah 5.0 Asia 2.8 81 DZA_elkah 6.0 Middle East 2.6 103 DZA_elkah 7.0 Sahel 1.8 90 DZA_elkah 8.0 Maghreb 1.8 109 DZA_elkah 9.0 Arab League 1.2 148 DZA_elkah 10.0 Atlantic Ocean 0.8 96 DZA_elwat 1.0 Sahara 27.0 16 DZA_elwat 2.0 Africa 20.0 121 DZA_elwat 3.0 European Union 10.2 100 DZA_elwat 4.0 Sahel 10.1 58 DZA_elwat 5.0 Europe 9.1 91 DZA_elwat 6.0 Maghreb 8.8 21 DZA_elwat 7.5 North Africa 2.5 157 DZA_elwat 7.5 Mediterranean Sea 2.5 84 DZA_elwat 9.0 Near East 1.9 108 DZA_elwat 10.0 African Union 1.6 51 FRA_figar 1.0 Europe 31.1 127 FRA_figar 2.0 European Union 26.5 163 FRA_figar 3.0 Mediterranean Sea 3.9 5 FRA_figar 4.0 Africa 3.8 67 FRA_figar 5.0 Alps 3.6 70 FRA_figar 6.0 Amazonia 2.7 99 FRA_figar 7.0 Sahel 2.6 25 FRA_figar 8.0 Americas 2.5 134 FRA_figar 9.0 NATO 2.2 170 FRA_figar 10.0 Polynesia 2.0 60 FRA_lmond 1.0 Europe 30.4 122 FRA_lmond 2.0 European Union 19.2 17 FRA_lmond 3.0 Africa 13.3 102 FRA_lmond 4.0 Sahel 4.3 69 FRA_lmond 5.0 Alps 3.6 161 FRA_lmond 6.0 Mediterranean Sea 3.4 71 FRA_lmond 7.0 Amazonia 1.9 138 FRA_lmond 8.0 NATO 1.8 30 FRA_lmond 9.0 Latin America 1.7 75 FRA_lmond 10.0 Middle East 1.6 120 GBR_guard 1.0 European Union 39.5 54 GBR_guard 2.0 Europe 22.6 12 GBR_guard 3.0 Africa 6.0 144 GBR_guard 4.0 Arctic 4.3 80 GBR_guard 5.0 Middle East 3.9 167 GBR_guard 6.0 Pacific Ocean 3.4 139 GBR_guard 7.0 NATO 2.4 146 GBR_guard 8.0 Atlantic Ocean 2.0 39 GBR_guard 9.0 Asia 1.7 29 GBR_guard 10.0 Latin America 1.6 129 GBR_teleg 1.0 European Union 49.2 50 GBR_teleg 2.0 Europe 26.1 11 GBR_teleg 3.0 Africa 7.6 38 GBR_teleg 4.0 Asia 2.5 143 GBR_teleg 5.0 Arctic 1.5 79 GBR_teleg 6.0 Middle East 1.3 114 GBR_teleg 7.5 Commonwealth of Nations 1.1 153 GBR_teleg 7.5 Caribbean 1.1 168 GBR_teleg 9.0 Pacific Ocean 1.0 31 GBR_teleg 10.0 Latin America 0.9 126 IRL_irtim 1.0 European Union 64.2 53 IRL_irtim 2.0 Europe 20.6 8 IRL_irtim 3.0 Africa 2.0 41 IRL_irtim 4.0 Asia 1.4 147 IRL_irtim 5.0 Atlantic Ocean 1.3 133 IRL_irtim 6.0 NATO 1.2 83 IRL_irtim 7.0 Middle East 1.1 169 IRL_irtim 8.0 Pacific Ocean 0.8 27 IRL_irtim 9.5 Americas 0.6 28 IRL_irtim 9.5 Latin America 0.6 125 NIR_belte 1.0 European Union 63.0 55 NIR_belte 2.0 Europe 19.9 3 NIR_belte 3.0 Africa 2.6 142 NIR_belte 4.0 Arctic 1.9 115 NIR_belte 5.0 Commonwealth of Nations 1.8 73 NIR_belte 6.0 Middle East 1.5 35 NIR_belte 7.0 Asia 1.4 152 NIR_belte 8.0 Caribbean 1.2 137 NIR_belte 9.0 NATO 1.1 149 NIR_belte 10.0 Atlantic Ocean 1.0 15 TUN_babne 1.0 Africa 29.2 116 TUN_babne 2.0 European Union 25.5 64 TUN_babne 3.0 Europe 17.5 104 TUN_babne 4.0 Sahel 5.7 86 TUN_babne 5.0 Maghreb 4.9 78 TUN_babne 6.0 Middle East 4.2 34 TUN_babne 7.0 Asia 2.8 111 TUN_babne 8.0 Arab League 2.5 164 TUN_babne 9.0 Mediterranean Sea 1.2 141 TUN_babne 10.0 NATO 1.0 6 TUN_ecoma 1.0 Africa 34.5 130 TUN_ecoma 2.0 European Union 23.1 52 TUN_ecoma 3.0 Europe 10.0 92 TUN_ecoma 4.0 Maghreb 8.2 159 TUN_ecoma 5.0 Mediterranean Sea 7.2 19 TUN_ecoma 6.0 North Africa 3.2 98 TUN_ecoma 7.0 Sahel 2.5 76 TUN_ecoma 8.0 Middle East 1.8 95 TUN_ecoma 9.0 Sahara 1.7 107 TUN_ecoma 10.5 African Union 1.2 113 TUN_ecoma 10.5 Arab League 1.2 7 TUN_press 1.0 Africa 33.1 160 TUN_press 2.0 Mediterranean Sea 19.3 124 TUN_press 3.0 European Union 11.4 105 TUN_press 4.0 Sahel 11.1 48 TUN_press 5.0 Europe 5.2 106 TUN_press 6.0 African Union 4.7 88 TUN_press 7.0 Maghreb 3.7 18 TUN_press 8.0 North Africa 2.8 94 TUN_press 9.0 Sahara 2.6 10 TUN_reali 1.0 Africa 37.6 119 TUN_reali 2.0 European Union 16.7 56 TUN_reali 3.0 Europe 14.7 97 TUN_reali 4.0 Sahel 6.7 87 TUN_reali 5.0 Maghreb 5.8 154 TUN_reali 6.0 Mediterranean Sea 4.5 93 TUN_reali 7.0 Sahara 4.0 82 TUN_reali 8.0 Middle East 2.5 20 TUN_reali 9.0 North Africa 2.1 110 TUN_reali 10.0 Arab League 1.4 59 TUR_cumhu 1.0 Europe 32.6 132 TUR_cumhu 2.0 European Union 18.3 44 TUR_cumhu 3.0 Asia Minor 13.4 155 TUR_cumhu 4.0 Mediterranean Sea 9.3 151 TUR_cumhu 5.0 Black Sea 7.1 140 TUR_cumhu 6.0 NATO 6.0 1 TUR_cumhu 7.0 Africa 2.5 40 TUR_cumhu 8.0 Asia 2.0 47 TUR_cumhu 9.0 Eurasia 1.5 22 TUR_cumhu 10.0 Southern Africa 1.2 62 TUR_yenis 1.0 Europe 25.5 128 TUR_yenis 2.0 European Union 19.3 162 TUR_yenis 3.0 Mediterranean Sea 13.3 150 TUR_yenis 4.0 Black Sea 11.8 45 TUR_yenis 5.0 Asia Minor 8.4 135 TUR_yenis 6.0 NATO 7.0 4 TUR_yenis 7.0 Africa 4.4 46 TUR_yenis 8.0 Eurasia 1.6 36 TUR_yenis 9.0 Asia 1.5 33 TUR_yenis 10.0 Antarctica 1.0 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
